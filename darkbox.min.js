var darkbox=function(){"use strict";var e={},t={imageIn:"fadein",imageOut:"fadeout",imageLeftIn:"",imageLeftOut:"",imageRightIn:"",imageRightOut:"",transitionTime:1e3,fileTypes:/\.(jpg|png|gif|jpeg|tif|tiff|svg)$/i,backgroundBlur:!0},i=document.createElement("div"),a=[],n=0,r=0,l=null,o=null,d=!1,s=function(e){e.stopPropagation(),"d-leftarrow"===e.target.id||"pathleft"===e.target.id?g("left"):"d-rightarrow"===e.target.id||"pathright"===e.target.id?g("right"):c()},m=function(e,a,n){l.className=n,setTimeout(function(){e.className=a,i.removeChild(l),i.appendChild(e),l=e,d||(l.className="")},t.transitionTime)},g=function(e){var i=null;"right"==e?(n!=a[r].length-1?i=a[r][++n]:(i=a[r][0],n=0),m(i,t.imageRightIn||t.imageIn,t.imageRightOut||t.imageOut)):(0!=n?i=a[r][--n]:(i=a[r][a[r].length-1],n=a[r].length-1),m(i,t.imageLeftIn||t.imageIn,t.imageLeftOut||t.imageOut))},c=function(){l.className=t.imageOut;var e=t.transitionTime-200>=0?t.transitionTime-200:0;setTimeout(function(){i.className="d-overlay animclear",o instanceof StyleSheet&&(o.disabled=!0)},e),setTimeout(function(){i.style.display="none",i.removeChild(l),i.className="d-overlay"},t.transitionTime)},u=function(e,i){var n=e.getAttribute("href")||e.getAttribute("src");if(void 0!=n){if(n=n.trim(),t.fileTypes.test(n)){var r=document.createElement("img");r.setAttribute("src",n),a[i].push(r),e.setAttribute("data-darkbox-index",a[i].length-1)}}else"li"!==e.tagName.toLowerCase()&&"figure"!==e.tagName.toLowerCase()||!e.firstElementChild||u(e.firstElementChild,i)},f=function(e){o=document.createElement("style"),o.type="text/css",o.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(o),o.disabled=!0};return e.init=function(e){if(e&&"object"==typeof e)for(var n in e)n in t&&(t[n]=e[n]);var r="Webkit Moz O ms Khtml".split(" ");if(i.style.animationName&&(animation=!0),d===!1)for(var l=0;l<r.length;l++)if(void 0!==i.style[r[l]+"AnimationName"]){d=!0;break}i.className="d-overlay",i.innerHTML='<svg class="d-leftarrow" id="d-leftarrow" width="40" height="40" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" fill="#CCCCCC"><path id="pathleft" d="M 416.00,416.00l-96.00,96.00L 64.00,256.00L 320.00,0.00l 96.00,96.00L 256.00,256.00L 416.00,416.00z" ></path></svg>',i.innerHTML+='<svg class="d-rightarrow" id="d-rightarrow" width="40" height="40" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" fill="#CCCCCC"><path id="pathright" d="M 64.00,416.00l 96.00,96.00l 256.00-256.00L 160.00,0.00L 64.00,96.00l 160.00,160.00L 64.00,416.00z" ></path></svg>',document.body.appendChild(i);var l,o,m,g=document.getElementsByClassName("darkbox"),c=null;for(l=0;l<g.length;l++)for(function(e){g[l].addEventListener("click",function(t){for(var i=t.target;i!==g[l];){if(m=i.getAttribute("data-darkbox-index")){darkbox.openDarkbox(e,m),t.preventDefault();break}i=i.parentNode}},!1)}(l),a[l]=[],o=0;o<g[l].children.length;o++)c=g[l].children[o],1===c.nodeType&&u(c,l);t.backgroundBlur&&(void 0!==document.body.style.webkitFilter?f("body > *:not(.d-overlay) {-webkit-filter: blur(20px);}"):void 0!==document.body.style.filter&&f("body > *:not(.d-overlay) {filter: blur(20px);}")),i.addEventListener("click",s,!1),i.addEventListener("touchend",function(e){e.currentTarget.removeEventListener("click",s,!1),s(e)},!1),console.log("darkbox initialised")},e.openDarkbox=function(e,s){o instanceof StyleSheet&&(o.disabled=!1),r=e,n=s,l=a[r][n],i.appendChild(l),i.className="d-overlay animopaque",i.style.display="block",l.className=t.imageIn,setTimeout(function(){i.className="d-overlay"},d&&400),d||(l.className="")},e}();